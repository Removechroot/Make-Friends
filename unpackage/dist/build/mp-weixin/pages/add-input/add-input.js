(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/add-input/add-input"],{"5e77":function(t,e,n){"use strict";var a;n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}));var o=function(){var t=this,e=t.$createElement;t._self._c},i=[]},"74f0":function(t,e,n){},a08d:function(t,e,n){"use strict";n.r(e);var a=n("5e77"),o=n("f65b");for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n("a3e3");var c,u=n("f0c5"),s=Object(u["a"])(o["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],c);e["default"]=s.exports},a2cf:function(t,e,n){"use strict";(function(t,a){function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){n.e("components/uni-ui/uni-nav-bar/uni-nav-bar").then(function(){return resolve(n("74b3"))}.bind(null,n)).catch(n.oe)},c=function(){Promise.all([n.e("common/vendor"),n.e("components/uni-ui/uni-upload-image")]).then(function(){return resolve(n("0ca4"))}.bind(null,n)).catch(n.oe)},u={components:{uniNavBar:i,uniUploadImage:c},data:function(){return{content:"",imageList:[],showback:!1,result:[],userInfo:{}}},computed:{show:function(){return this.imageList.length>0}},onBackPress:function(){if(!this.showback&&(this.imageList.length>0||""!==this.content))return this.goblackmodal(),!0},onLoad:function(){var e=this,n=this;if(t.getStorageSync("token")){var o=t.getStorageSync("token");a.callFunction({name:"user-center",data:{action:"checkToken",params:{token:o}},success:function(e){var a=e.result;if(a.code>0)return t.showModal({title:"未登录或者登录过期",showCancel:!1});n.userInfo=a.userInfo.userInfo,n.uid=a.userInfo._id}})}else t.showModal({content:"用户未登录正在使用临时登录凭证",showCancel:!1}),n.userInfo={avatarUrl:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-mf-ser1/5c225bb0-093e-11eb-b244-a9f5e5565f30.jpg",city:"",country:"Other",gender:1,language:"zh_CN",nickName:"测试用户",province:"Southern"},n.uid="AHJSBDJKHASDJKHASJDHsahdhjasjasdj";t.getStorage({key:"add_input",success:function(t){var n=JSON.parse(t.data);e.content=n.content,e.imageList=n.imageList}})},methods:{changeimages:function(t){this.imageList=t},store:function(){t.setStorage({key:"add_input",data:JSON.stringify({content:this.content,imageList:this.imageList})})},removestore:function(){t.removeStorage({key:"add_input"})},goblack:function(){t.navigateBack()},goblackmodal:function(){var e,n=this;t.showModal((e={content:"你是不是想保存草稿啊靓仔！",showCancel:""},o(e,"showCancel",!0),o(e,"cancelText","不保存"),o(e,"confirmText","保存"),o(e,"complete",(function(e){e.confirm?n.store():n.removestore(),t.navigateBack()})),e)),this.showback=!0},iconClickEvent:function(t){switch(t){case"uploadImage":this.$refs.uploadImage.chooseImage();break}},SendDynamic:function(){var e=this;if(t.showToast({title:"发布中",icon:"loading"}),this.imageList.length>0)for(var n=0;n<this.imageList.length;n++)a.uploadFile({cloudPath:"images/".concat(Date.now(),".jpg"),filePath:this.imageList[n]}).then((function(t){t.success&&(e.result.push({imgUrl:t.fileID}),e.updatacloud())}));else this.updatacloud()},updatacloud:function(){a.callFunction({name:"add-input",data:{username:this.userInfo.nickName,userpic:this.userInfo.avatarUrl.length>0?this.userInfo.avatarUrl:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-mf-ser1/5c225bb0-093e-11eb-b244-a9f5e5565f30.jpg",newstime:Date.now(),isFollow:!1,title:this.content,titlepic:this.result.length>0?this.result:[],support:{type:"",support_count:0,unsupport_count:0},comment_count:0,share_name:0,review:[],Uid:this.uid}}).then((function(){t.showToast({title:"发布成功",success:function(){t.reLaunch({url:"../home/index"})}})}))}}};e.default=u}).call(this,n("543d")["default"],n("a9ff")["default"])},a3e3:function(t,e,n){"use strict";var a=n("74f0"),o=n.n(a);o.a},f65b:function(t,e,n){"use strict";n.r(e);var a=n("a2cf"),o=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=o.a},f940:function(t,e,n){"use strict";(function(t){n("d0df");a(n("66fd"));var e=a(n("a08d"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])}},[["f940","common/runtime","common/vendor"]]]);